## Is the weather endpoint ok? The page we are now on is just a ball of json
function getYYYYMMDD() {
var date = new Date() 
  var year = date.getFullYear()
  var month = (date.getMonth() + 1).toString().padStart(2, '0')
  var day = date.getDate().toString().padStart(2, '0')
  return year + month + day
}
var substring = getYYYYMMDD()
var pageContent = document.body.innerHTML  
  if (pageContent.includes(substring)) {
    return true
  } else { 
  return false
  }


## Is analytics for 'pageview' ready? 

return new Promise((r) => { 
  setTimeout(() => { 
    window.analytics.ready.then(()=> { 
    const flag = window.analytics.analytics.getState("track")?.history.filter((entry)=> entry.event === "page-view")
        if ( flag !== undefined && flag?.length >= 1 ) {
            r(true) 
        } else { 
         window.analytics.analytics.once("track", ({payload})=>{ 
               r(payload.type === "track" && payload.event === "page-view")               
         })  
        
        } 

    }) 
  }, 5000);
}) 


## Listen for outgoing http calls: 
function sleep(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}
function addCalls() {
    const networkCalls = window.performance
        .getEntriesByType('resource')
        .map((entry) => entry.name);
        
        // Actual logic will go here!
        
    return networkCalls
}

async function main(ms) {
    await sleep(ms);
    const ary = addCalls()
    return ary
}
let collection = {} 
collection["a"] = await main(0)
collection["b"] = await main(10000)
for ( let k in collection ) { 
  console.log("THIS IS k=" + k ) 
  const obj = collection[k] 
  for ( let thing in obj ) { 
    console.log( thing + "   "  + obj[thing] ) 
  } 
} 
console.log("one")
console.log("two")
console.log("three")
console.log("four")
console.log("five")
console.log("six")
console.log("seven")
if ( collection['b'].length > 0 ) { 
console.error("b len is " + collection['b'].length ) 
  return true
} else { 
  return false
}
